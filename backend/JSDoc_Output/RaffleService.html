<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: RaffleService</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: RaffleService</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>RaffleService<span class="signature">(itemModel, userModel)</span><span class="type-signature"> &rarr; {<a href="RaffleService.html">RaffleService</a>}</span></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    
    <h4 class="name" id="RaffleService"><span class="type-signature"></span>new RaffleService<span class="signature">(itemModel, userModel)</span><span class="type-signature"> &rarr; {<a href="RaffleService.html">RaffleService</a>}</span></h4>
    

    



<div class="description">
    A standalone service to help with raffle lifecycle events, such as randomly selecting a winner and updating databases
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>itemModel</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="ItemModel.html">ItemModel</a></span>


            
            </td>

            

            

            <td class="description last">The ItemModel that provides access to the Item/Bid Database</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>userModel</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="UserModel.html">UserModel</a></span>


            
            </td>

            

            

            <td class="description last">The UserModel that provides access to the User Database</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="services_raffle.js.html">services/raffle.js</a>, <a href="services_raffle.js.html#line9">line 9</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns an instance of RaffleService
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="RaffleService.html">RaffleService</a></span>


    </dd>
</dl>

    





    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="~chooseAndNotifyWinner"><span class="type-signature">(async, inner) </span>chooseAndNotifyWinner<span class="signature">(item)</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    



<div class="description">
    This method does the entire winner selection process, handling all 
database calls and email notifications

What this method does
1. Selects winner with weighted random
2. Set that bid as the winner
3. Get user info for seller and winner
4. Send alert email to the winner
TODO: Get shipping info here? From seller's zip code to winner's address
TODO: Send shipping info email to the seller
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>item</code></td>
            

            <td class="type">
            
                
<span class="param-type">Item</span>


            
            </td>

            

            

            <td class="description last">Item Object with status "AR" (aka, ready to have winner selected)</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="services_raffle.js.html">services/raffle.js</a>, <a href="services_raffle.js.html#line26">line 26</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - ID of the winning Bid, -1 if an error (Error will be logged to console)
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    





        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AuthService.html">AuthService</a></li><li><a href="ItemModel.html">ItemModel</a></li><li><a href="ItemRepo.html">ItemRepo</a></li><li><a href="RaffleService.html">RaffleService</a></li><li><a href="UserModel.html">UserModel</a></li><li><a href="UserRepo.html">UserRepo</a></li></ul><h3>Global</h3><ul><li><a href="global.html#PostgresDB">PostgresDB</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Feb 20 2020 23:08:27 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>